---
const { class: className } = Astro.props;
import Menu from "@/icons/Menu.astro";
import { Cancel } from "@/icons/Cancel.jsx";
---

<nav class={`text-white w-full ${className}`}>
  <div class="flex gap-7 md:hidden justify-between items-center px-0 pt-4">
    <span
      class="glass-version relative overflow-hidden bg-purple-400/20 backdrop-blur-lg border border-purple-400/25 px-3 py-1 rounded-full text-white/85 font-semibold cursor-default transition-all duration-300 ease-out text-xs"
    >
      v1.0.0
    </span>
    <button
      id="hamburger-btn"
      class="bg-blue-100/20 hover:bg-white/20 transition-colors backdrop-blur-lg shadow-md border border-white/12 p-2 rounded-lg"
      aria-label="Toggle menu"
    >
      <Menu class="w-6 h-6" />
    </button>
  </div>

  <div
    id="mobile-menu"
    class="hidden md:hidden fixed top-0 left-0 w-full h-full bg-dark-200/95 backdrop-blur-xl z-99 flex flex-col items-center justify-center gap-6 animate-fade-in"
  >
    <button
      id="close-menu-btn"
      class="absolute top-11 right-7.5 bg-blue-100/20 hover:bg-white/20 transition-colors backdrop-blur-lg shadow-md border border-white/12 p-2 rounded-lg text-white/60"
      aria-label="Close menu"
    >
      <Cancel class="w-6 h-6" />
    </button>

    <a
      href="/"
      class="bg-blue-100/20 hover:bg-white/20 transition-colors backdrop-blur-lg shadow-md border border-white/12 px-8 py-3 rounded-full text-lg font-medium"
      >Home</a
    >
    <a
      href="/how-to-collab"
      class="bg-blue-100/20 hover:bg-white/20 transition-colors backdrop-blur-lg shadow-md border border-white/12 px-8 py-3 rounded-full text-lg font-medium"
      >How to collab</a
    >
    <button
      id="open-purpose-modal-mobile"
      class="bg-blue-100/20 hover:bg-white/20 transition-colors backdrop-blur-lg shadow-md border border-white/12 px-8 py-3 rounded-full text-lg font-medium cursor-pointer"
      >Our Purpose</button
    >
  </div>

  <ul class="hidden md:flex w-full justify-between">
    <li class="flex gap-4 items-center pl-4">
      <span
        class="glass-version relative overflow-hidden bg-purple-400/20 backdrop-blur-lg border border-purple-400/25 px-6 rounded-full text-white/85 font-semibold cursor-default transition-all duration-300 ease-out"
      >
        v1.0.0
      </span>
      <a
        href="/"
        class="bg-blue-100/20 hover:bg-white/20 transition-colors backdrop-blur-lg shadow-md border border-white/12 px-4 rounded-full text-[1.1rem]"
        >Home</a
      >
    </li>

    <li class="flex gap-4 items-center pr-4">
      <a
        href="/how-to-collab"
        class="bg-blue-100/20 hover:bg-white/20 transition-colors backdrop-blur-lg shadow-md border border-white/12 px-4 rounded-full text-[1.1rem]"
        >How to collab</a
      >
      <button
        id="open-purpose-modal"
        class="bg-blue-100/20 hover:bg-white/20 transition-colors backdrop-blur-lg shadow-md border border-white/12 px-4 rounded-full text-[1.1rem] cursor-pointer"
        >Our Purpose</button
      >
    </li>
  </ul>
</nav>

<script>
  import { isPurposeModalOpen } from '@/stores/modalStore';
  
  document.addEventListener('DOMContentLoaded', () => {
    const button = document.getElementById('open-purpose-modal');
    if (button) {
      button.addEventListener('click', () => {
        isPurposeModalOpen.set(true);
      });
    }

    const mobileButton = document.getElementById('open-purpose-modal-mobile');
    if (mobileButton) {
      mobileButton.addEventListener('click', () => {
        isPurposeModalOpen.set(true);
        const mobileMenu = document.getElementById('mobile-menu');
        if (mobileMenu) {
          mobileMenu.classList.add('hidden');
          document.body.style.overflow = 'auto';
        }
      });
    }

    const hamburgerBtn = document.getElementById('hamburger-btn');
    const mobileMenu = document.getElementById('mobile-menu');
    const closeMenuBtn = document.getElementById('close-menu-btn');

    if (hamburgerBtn && mobileMenu) {
      hamburgerBtn.addEventListener('click', () => {
        mobileMenu.classList.remove('hidden');
        document.body.style.overflow = 'hidden';
      });
    }

    if (closeMenuBtn && mobileMenu) {
      closeMenuBtn.addEventListener('click', () => {
        mobileMenu.classList.add('hidden');
        document.body.style.overflow = 'auto';
      });
    }

    const mobileLinks = mobileMenu?.querySelectorAll('a');
    mobileLinks?.forEach(link => {
      link.addEventListener('click', () => {
        mobileMenu.classList.add('hidden');
        document.body.style.overflow = 'auto';
      });
    });
  });
</script>

<style>
  .glass-version {
    box-shadow:
      0 4px 16px rgba(162, 148, 252, 0.1),
      inset 0 1px 0 rgba(255, 255, 255, 0.2);
    animation: subtle-pulse 3s ease-in-out infinite;
  }

  @keyframes subtle-pulse {
    0%,
    100% {
      box-shadow:
        0 4px 16px rgba(162, 148, 252, 0.1),
        inset 0 1px 0 rgba(255, 255, 255, 0.2);
    }
    50% {
      box-shadow:
        0 4px 20px rgba(162, 148, 252, 0.2),
        inset 0 1px 0 rgba(255, 255, 255, 0.3);
    }
  }

  @keyframes fade-in {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }

  .animate-fade-in {
    animation: fade-in 0.2s ease-out;
  }
</style>